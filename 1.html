Some changes by Nikita Vernigora (@vernigora2)